name: incus-agent
depends:
  - path: /dev/virtio-ports/org.linuxcontainers.incus
container:
  entrypoint: ./incus-agent-wrapper
  security:
    writeableRootfs: true
  mounts:
    - source: /dev
      destination: /dev
      type: bind
      options:
        - rw
        - rbind
    - source: /run/incus_agent
      destination: /run/incus_agent
      type: bind
      options:
        - rw
        - rbind
    - source: /sys
      destination: /sys
      type: bind
      options:
        - ro
        - rbind
    - source: /proc
      destination: /proc
      type: bind
      options:
        - ro
        - rbind
restart: always
